<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¦´ìŠ¤ì»µ íˆ¬í‘œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 40px;
        }

        /* ë¡œê·¸ì¸ ì„¹ì…˜ */
        .login-section {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .login-input {
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 1em;
            width: 100%;
            max-width: 300px;
            transition: border-color 0.3s ease;
        }

        .login-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1em;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .user-info {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: none;
        }

        .user-info.show {
            display: block;
        }

        /* íˆ¬í‘œ ì„¹ì…˜ */
        .voting-section {
            display: none;
        }

        .voting-section.show {
            display: block;
        }

        .seats-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            gap: 20px;
        }

        .seat-counter {
            flex: 1;
            padding: 20px;
            border-radius: 15px;
            color: white;
            font-weight: bold;
        }

        .seat-counter.topic1 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .seat-counter.topic2 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .seat-number {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .seat-text {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .topics-container {
            display: flex;
            gap: 30px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .topic-card {
            flex: 1;
            min-width: 300px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            padding: 30px 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .topic-card:nth-child(2) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .topic-card:hover:not(.disabled) {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .topic-card.selected {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            border: 3px solid #fff;
        }

        .topic-card.selected::before {
            content: "âœ“ ì„ íƒë¨";
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .topic-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .topic-card.disabled::after {
            content: "ì •ì› ë§ˆê°";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1em;
        }

        .topic-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .topic-description {
            font-size: 1em;
            opacity: 0.9;
            line-height: 1.5;
        }

        .vote-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 30px auto;
            display: block;
            opacity: 0.5;
            pointer-events: none;
        }

        .vote-button.active {
            opacity: 1;
            pointer-events: auto;
        }

        .vote-button:hover.active {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        /* ê´€ë¦¬ì ë¡œê·¸ì¸ ì„¹ì…˜ */
        .admin-login-section {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 0, 0, 0.05);
            border: 2px dashed rgba(255, 0, 0, 0.2);
            border-radius: 15px;
        }

        .admin-login-form {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .admin-input {
            padding: 8px 15px;
            border: 2px solid #ffcccb;
            border-radius: 20px;
            font-size: 0.9em;
            width: 100%;
            max-width: 200px;
            transition: border-color 0.3s ease;
        }

        .admin-input:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .admin-login-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 8px 20px;
            font-size: 0.9em;
            font-weight: bold;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-login-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        /* ê´€ë¦¬ì íŒ¨ë„ */
        .admin-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 107, 107, 0.3);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 1000;
            min-width: 200px;
        }

        .admin-panel.show {
            display: block;
        }

        .admin-panel h4 {
            color: #ff6b6b;
            margin-bottom: 15px;
            text-align: center;
        }
        /* ê´€ë¦¬ì ê¸°ëŠ¥ */
        .admin-section {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid rgba(255, 0, 0, 0.2);
            border-radius: 15px;
            display: none;
        }

        .admin-section.show {
            display: block;
        }

        .admin-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 0.9em;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px 0;
            width: 100%;
        }

        .admin-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.4);
        }

        .admin-logout {
            background: linear-gradient(45deg, #999, #777);
            font-size: 0.8em;
            padding: 8px 15px;
            margin-top: 10px;
        }
        .participants-section {
            margin-top: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            display: none;
        }

        .participants-section.show {
            display: block;
        }

        .participants-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .participant-list {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
        }

        .participant-list h4 {
            margin-bottom: 15px;
            color: #333;
        }

        .participant-list.topic1 h4 {
            color: #f5576c;
        }

        .participant-list.topic2 h4 {
            color: #00f2fe;
        }

        .participant-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 20px;
            font-size: 0.9em;
        }

        .logout-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #666;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .logout-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .topics-container {
                flex-direction: column;
            }
            
            .topic-card {
                min-width: auto;
            }
            
            .seats-info {
                flex-direction: column;
            }
            
            .participants-grid {
                grid-template-columns: 1fr;
            }
            
            .logo {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="logout-button" onclick="logout()" style="display: none;" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
        
        <div class="logo">ğŸ¬ ë¦´ìŠ¤ì»µ</div>
        <div class="subtitle">ì–´ë–¤ ì£¼ì œê°€ ë” í¥ë¯¸ë¡œìš°ì‹ ê°€ìš”? ì„ íƒí•´ì£¼ì„¸ìš”!</div>
        
        <!-- ë¡œê·¸ì¸ ì„¹ì…˜ -->
        <div class="login-section" id="loginSection">
            <h3 style="margin-bottom: 20px; color: #333;">ì°¸ê°€ì ì •ë³´ ì…ë ¥</h3>
            <div class="login-form">
                <input type="text" class="login-input" id="userName" placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" maxlength="20">
                <button class="login-button" onclick="login()">ì°¸ì—¬í•˜ê¸°</button>
            </div>
            
            <!-- ê´€ë¦¬ì ë¡œê·¸ì¸ -->
            <div class="admin-login-section">
                <h4 style="margin-bottom: 15px; color: #ff6b6b; font-size: 0.9em;">ğŸ”§ ê´€ë¦¬ì ë¡œê·¸ì¸</h4>
                <div class="admin-login-form">
                    <input type="text" class="admin-input" id="adminId" placeholder="ê´€ë¦¬ì ID" maxlength="20">
                    <input type="password" class="admin-input" id="adminPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" maxlength="20">
                    <button class="admin-login-button" onclick="adminLogin()">ê´€ë¦¬ì ë¡œê·¸ì¸</button>
                </div>
            </div>
        </div>

        <!-- ì‚¬ìš©ì ì •ë³´ -->
        <div class="user-info" id="userInfo">
            <strong id="welcomeMessage"></strong>
        </div>
        
        <!-- íˆ¬í‘œ ì„¹ì…˜ -->
        <div class="voting-section" id="votingSection">
            <!-- ë‚¨ì€ ìë¦¬ ì •ë³´ -->
            <div class="seats-info">
                <div class="seat-counter topic1">
                    <div class="seat-number" id="seats1">ìµœëŒ€ 20ëª…</div>
                    <div class="seat-text" id="seatText1">(20ìë¦¬ ë‚¨ìŒ)</div>
                </div>
                <div class="seat-counter topic2">
                    <div class="seat-number" id="seats2">ìµœëŒ€ 20ëª…</div>
                    <div class="seat-text" id="seatText2">(20ìë¦¬ ë‚¨ìŒ)</div>
                </div>
            </div>
            
            <div class="topics-container">
                <div class="topic-card" onclick="selectTopic(1)" id="topic1Card">
                    <div class="topic-title">ì£¼ì œ A</div>
                    <div class="topic-description">ëª°ì…ì˜ë°© êµ¬ë§¤ì „í™˜ ë¦´ìŠ¤ ë§Œë“¤ê¸°</div>
                </div>
                
                <div class="topic-card" onclick="selectTopic(2)" id="topic2Card">
                    <div class="topic-title">ì£¼ì œ B</div>
                    <div class="topic-description">ì•„ì¹´ë°ë¯¸ ì›ë°ì´ ë¶€íŠ¸ìº í”„ ì „í™˜ ë¦´ìŠ¤ ë§Œë“¤ê¸°</div>
                </div>
            </div>
            
            <button class="vote-button" onclick="submitVote()" id="voteButton">íˆ¬í‘œí•˜ê¸°</button>
        </div>

        <!-- ê´€ë¦¬ì íŒ¨ë„ -->
        <div class="admin-panel" id="adminPanel">
            <h4>ğŸ”§ ê´€ë¦¬ì íŒ¨ë„</h4>
            <button class="admin-button" onclick="resetVotes()">íˆ¬í‘œ ì´ˆê¸°í™”</button>
            <button class="admin-button" onclick="toggleParticipants()">ë°ì´í„° ëª…ë‹¨ ë³´ê¸°</button>
            <button class="admin-button admin-logout" onclick="adminLogout()">ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ</button>
        </div>

        <!-- ê´€ë¦¬ì ê¸°ëŠ¥ -->
        <div class="admin-section" id="adminSection" style="display: none;">
        </div>

        <!-- ì°¸ê°€ì ëª©ë¡ -->
        <div class="participants-section" id="participantsSection">
            <h3 style="color: #333; margin-bottom: 20px;">ì°¸ê°€ì í˜„í™©</h3>
            <div class="participants-grid">
                <div class="participant-list topic1">
                    <h4>ì£¼ì œ A ì°¸ê°€ì (<span id="topic1Count">0</span>/20)</h4>
                    <div id="topic1Participants"></div>
                </div>
                <div class="participant-list topic2">
                    <h4>ì£¼ì œ B ì°¸ê°€ì (<span id="topic2Count">0</span>/20)</h4>
                    <div id="topic2Participants"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Firebase ì„¤ì • (ì‹¤ì œ ì‚¬ìš©ì‹œ ë³¸ì¸ì˜ Firebase ì„¤ì •ìœ¼ë¡œ êµì²´)
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getDatabase, ref, set, push, onValue, get } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js';

        // Firebase ì„¤ì • (ë°ëª¨ìš© - ì‹¤ì œ ì‚¬ìš©ì‹œ ë³¸ì¸ì˜ ì„¤ì • ì‚¬ìš©)
        const firebaseConfig = {
            // ì—¬ê¸°ì— Firebase í”„ë¡œì íŠ¸ ì„¤ì •ì„ ì…ë ¥í•˜ì„¸ìš”
            // í˜„ì¬ëŠ” ë¡œì»¬ ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œë¡œ ì‘ë™í•©ë‹ˆë‹¤
        };

        // Firebase ì—°ê²° ì‹œë®¬ë ˆì´ì…˜ì„ ìœ„í•œ ë¡œì»¬ ë°ì´í„°
        let localData = {
            participants: {},
            votes: { topic1: 0, topic2: 0 },
            maxSeats: 20
        };

        // ì „ì—­ ë³€ìˆ˜
        window.selectedTopic = 0;
        window.currentUser = null;
        window.hasVoted = false;
        window.isAdminLoggedIn = false;

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
        function loadLocalData() {
            const saved = localStorage.getItem('reelsCupData');
            if (saved) {
                localData = JSON.parse(saved);
            }
            updateUI();
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
        function saveLocalData() {
            localStorage.setItem('reelsCupData', JSON.stringify(localData));
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            // ë‚¨ì€ ìë¦¬ ì—…ë°ì´íŠ¸
            const remainingSeats1 = localData.maxSeats - localData.votes.topic1;
            const remainingSeats2 = localData.maxSeats - localData.votes.topic2;
            
            document.getElementById('seats1').textContent = `ìµœëŒ€ ${localData.maxSeats}ëª…`;
            document.getElementById('seats2').textContent = `ìµœëŒ€ ${localData.maxSeats}ëª…`;
            
            document.getElementById('seatText1').textContent = `(${remainingSeats1}ìë¦¬ ë‚¨ìŒ)`;
            document.getElementById('seatText2').textContent = `(${remainingSeats2}ìë¦¬ ë‚¨ìŒ)`;

            // ì •ì› ë§ˆê° ì²˜ë¦¬
            if (remainingSeats1 <= 0) {
                document.getElementById('topic1Card').classList.add('disabled');
                document.getElementById('seatText1').textContent = '(ë§ˆê°)';
            } else {
                document.getElementById('topic1Card').classList.remove('disabled');
            }

            if (remainingSeats2 <= 0) {
                document.getElementById('topic2Card').classList.add('disabled');
                document.getElementById('seatText2').textContent = '(ë§ˆê°)';
            } else {
                document.getElementById('topic2Card').classList.remove('disabled');
            }

            // ì°¸ê°€ì ëª©ë¡ ì—…ë°ì´íŠ¸
            updateParticipantsList();
        }

        // ì°¸ê°€ì ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateParticipantsList() {
            const topic1List = document.getElementById('topic1Participants');
            const topic2List = document.getElementById('topic2Participants');
            
            topic1List.innerHTML = '';
            topic2List.innerHTML = '';

            let topic1Count = 0;
            let topic2Count = 0;

            Object.values(localData.participants).forEach(participant => {
                const participantDiv = document.createElement('div');
                participantDiv.className = 'participant-item';
                participantDiv.textContent = participant.name;

                if (participant.vote === 1) {
                    topic1List.appendChild(participantDiv);
                    topic1Count++;
                } else if (participant.vote === 2) {
                    topic2List.appendChild(participantDiv);
                    topic2Count++;
                }
            });

            document.getElementById('topic1Count').textContent = topic1Count;
            document.getElementById('topic2Count').textContent = topic2Count;
        }

        // ê´€ë¦¬ì ë¡œê·¸ì¸
        window.adminLogin = function() {
            const adminId = document.getElementById('adminId').value.trim();
            const adminPassword = document.getElementById('adminPassword').value.trim();
            
            if (adminId === 'admin' && adminPassword === 'admin4321') {
                window.isAdminLoggedIn = true;
                document.getElementById('adminPanel').classList.add('show');
                
                // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('adminId').value = '';
                document.getElementById('adminPassword').value = '';
                
                alert('ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸í–ˆìŠµë‹ˆë‹¤! ğŸ”§');
            } else {
                alert('ê´€ë¦¬ì ID ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        };

        // ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ
        window.adminLogout = function() {
            if (confirm('ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                window.isAdminLoggedIn = false;
                document.getElementById('adminPanel').classList.remove('show');
                
                // ì°¸ê°€ì ëª©ë¡ ìˆ¨ê¸°ê¸°
                document.getElementById('participantsSection').classList.remove('show');
                document.getElementById('participantsSection').style.display = 'none';
                
                // ê´€ë¦¬ì ë²„íŠ¼ í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
                const toggleBtn = document.querySelector('.admin-panel .admin-button:nth-child(2)');
                if (toggleBtn) {
                    toggleBtn.textContent = 'ë°ì´í„° ëª…ë‹¨ ë³´ê¸°';
                }
                
                alert('ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        };
        window.login = function() {
            const userName = document.getElementById('userName').value.trim();
            if (!userName) {
                alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            // ê´€ë¦¬ì ì²´í¬
            const isAdmin = userName.toLowerCase() === 'admin' || userName.toLowerCase() === 'ê´€ë¦¬ì';

            // ì¼ë°˜ ì‚¬ìš©ì ì¤‘ë³µ ì´ë¦„ ì²´í¬ (ê´€ë¦¬ìëŠ” ì œì™¸)
            if (!isAdmin) {
                const existingUser = Object.values(localData.participants).find(p => p.name === userName);
                if (existingUser) {
                    alert('ì´ë¯¸ ì°¸ì—¬í•œ ì´ë¦„ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë¦„ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
                    return;
                }
            }

            window.currentUser = {
                name: userName,
                id: Date.now().toString(),
                isAdmin: isAdmin
            };

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('userInfo').classList.add('show');
            
            if (isAdmin) {
                document.getElementById('welcomeMessage').textContent = `ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸í–ˆìŠµë‹ˆë‹¤, ${userName}ë‹˜! ğŸ”§`;
                document.getElementById('adminSection').classList.add('show');
            } else {
                document.getElementById('welcomeMessage').textContent = `í™˜ì˜í•©ë‹ˆë‹¤, ${userName}ë‹˜! ğŸ‰`;
            }
            
            document.getElementById('votingSection').classList.add('show');
            document.getElementById('logoutBtn').style.display = 'block';

            updateUI();
        };

        // ì£¼ì œ ì„ íƒ
        window.selectTopic = function(topicNumber) {
            if (window.hasVoted) return;
            
            // ì •ì› ì²´í¬
            if (topicNumber === 1 && localData.votes.topic1 >= localData.maxSeats) {
                alert('ì£¼ì œ AëŠ” ì •ì›ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.');
                return;
            }
            if (topicNumber === 2 && localData.votes.topic2 >= localData.maxSeats) {
                alert('ì£¼ì œ BëŠ” ì •ì›ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì´ì „ ì„ íƒ ì œê±°
            document.querySelectorAll('.topic-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // ìƒˆë¡œìš´ ì„ íƒ ì¶”ê°€
            if (topicNumber === 1) {
                document.getElementById('topic1Card').classList.add('selected');
            } else {
                document.getElementById('topic2Card').classList.add('selected');
            }
            
            window.selectedTopic = topicNumber;
            
            // íˆ¬í‘œ ë²„íŠ¼ í™œì„±í™”
            document.getElementById('voteButton').classList.add('active');
        };

        // íˆ¬í‘œ ì œì¶œ
        window.submitVote = function() {
            if (window.selectedTopic === 0 || window.hasVoted || !window.currentUser) return;
            
            // ì •ì› ì¬ì²´í¬
            if (window.selectedTopic === 1 && localData.votes.topic1 >= localData.maxSeats) {
                alert('ì£¼ì œ AëŠ” ì •ì›ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.');
                return;
            }
            if (window.selectedTopic === 2 && localData.votes.topic2 >= localData.maxSeats) {
                alert('ì£¼ì œ BëŠ” ì •ì›ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.');
                return;
            }

            // íˆ¬í‘œ ë°ì´í„° ì €ì¥
            localData.participants[window.currentUser.id] = {
                name: window.currentUser.name,
                vote: window.selectedTopic,
                timestamp: Date.now()
            };

            if (window.selectedTopic === 1) {
                localData.votes.topic1++;
            } else {
                localData.votes.topic2++;
            }

            window.hasVoted = true;
            saveLocalData();
            
            // UI ì—…ë°ì´íŠ¸
            updateUI();
            
            // íˆ¬í‘œ ì™„ë£Œ ì²˜ë¦¬
            document.querySelectorAll('.topic-card').forEach(card => {
                card.style.opacity = '0.7';
                card.style.pointerEvents = 'none';
            });
            
            document.getElementById('voteButton').style.display = 'none';
            
            const topicName = window.selectedTopic === 1 ? 'A' : 'B';
            alert(`ì£¼ì œ ${topicName}ì— íˆ¬í‘œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ‰`);
        };

        // ê´€ë¦¬ì ê¸°ëŠ¥ë“¤
        window.resetVotes = function() {
            if (!window.isAdminLoggedIn) {
                alert('ê´€ë¦¬ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.');
                return;
            }
            
            if (confirm('ì •ë§ë¡œ ëª¨ë“  íˆ¬í‘œë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                localData = {
                    participants: {},
                    votes: { topic1: 0, topic2: 0 },
                    maxSeats: 20
                };
                saveLocalData();
                updateUI();
                alert('íˆ¬í‘œê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        };

        window.toggleParticipants = function() {
            if (!window.isAdminLoggedIn) {
                alert('ê´€ë¦¬ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.');
                return;
            }
            
            const participantsSection = document.getElementById('participantsSection');
            const toggleBtn = event.target;
            
            if (participantsSection.style.display === 'none' || !participantsSection.classList.contains('show')) {
                participantsSection.classList.add('show');
                participantsSection.style.display = 'block';
                toggleBtn.textContent = 'ë°ì´í„° ëª…ë‹¨ ìˆ¨ê¸°ê¸°';
            } else {
                participantsSection.classList.remove('show');
                participantsSection.style.display = 'none';
                toggleBtn.textContent = 'ë°ì´í„° ëª…ë‹¨ ë³´ê¸°';
            }
        };

        // ë¡œê·¸ì•„ì›ƒ
        window.logout = function() {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                window.currentUser = null;
                window.hasVoted = false;
                window.selectedTopic = 0;
                
                document.getElementById('loginSection').style.display = 'block';
                document.getElementById('userInfo').classList.remove('show');
                document.getElementById('votingSection').classList.remove('show');
                document.getElementById('participantsSection').classList.remove('show');
                document.getElementById('adminSection').classList.remove('show');
                document.getElementById('logoutBtn').style.display = 'none';
                document.getElementById('userName').value = '';
                
                // ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
                document.querySelectorAll('.topic-card').forEach(card => {
                    card.classList.remove('selected');
                    card.style.opacity = '1';
                    card.style.pointerEvents = 'auto';
                });
                
                document.getElementById('voteButton').classList.remove('active');
                document.getElementById('voteButton').style.display = 'block';
                
                // ê´€ë¦¬ì ë²„íŠ¼ í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
                const toggleBtn = document.querySelector('.admin-button:last-child');
                if (toggleBtn) {
                    toggleBtn.textContent = 'ì°¸ê°€ì ëª©ë¡ ë³´ê¸°';
                }
            }
        };

        // í˜ì´ì§€ ë¡œë“œì‹œ ë°ì´í„° ë¡œë“œ
        loadLocalData();

        // ì£¼ê¸°ì ìœ¼ë¡œ UI ì—…ë°ì´íŠ¸ (ë‹¤ë¥¸ ì‚¬ìš©ìì˜ íˆ¬í‘œ ë°˜ì˜)
        setInterval(updateUI, 2000);
    </script>
</body>
</html>